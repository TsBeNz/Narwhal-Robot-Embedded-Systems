function [Ttraj,delta] = findvmaxquintic(vmax,Tinitial,step,q0,qf,v0,vf,a0,af)
    T = Tinitial;
    while 1
        Vmaxsimplify = v0 + a0*(((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))/((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + (T*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af)) - (2.5000*(((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))/((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + (T*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af))^4*(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))/T^5 - (1.5000*(((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))/((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + (T*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af))^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/T^3 + (2*(((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))/((((T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^2 - ((0.0400*T^2*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^2)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2 - (0.1000*T^2*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af))^3)^(1/2) + (T^5*a0)/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af) + (0.0080*T^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af)^3)/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^3 - (0.0300*T^3*(20*q0 - 20*qf + 12*T*v0 + 8*T*vf + 3*T^2*a0 - T^2*af)*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(12*q0 - 12*qf + 6*T*v0 + 6*T*vf + T^2*a0 - T^2*af)^2)^0.3333 + (T*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/(60*q0 - 60*qf + 30*T*v0 + 30*T*vf + 5*T^2*a0 - 5*T^2*af))^3*(30*q0 - 30*qf + 16*T*v0 + 14*T*vf + 3*T^2*a0 - 2*T^2*af))/T^4;
        if (vmax - Vmaxsimplify <= 0.01 || vmax == Vmaxsimplify)
            Ttraj = T;
            delta = vmax - Vmaxsimplify;
            break
        elseif (Vmaxsimplify > vmax)
            disp('edit step')
            break
        else
            T = T+step;
        end
    end
end

